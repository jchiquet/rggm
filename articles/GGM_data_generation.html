<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generating Gaussian data from a Graphical Model with SBM structure • rggm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Generating Gaussian data from a Graphical Model with SBM structure">
<meta property="og:description" content="rggm">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rggm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a>
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/GGM_data_generation.html">Gaussian data from SBM</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jchiquet/rggm">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Generating Gaussian data from a Graphical Model with SBM structure</h1>
            
            <h4 class="date">27 March, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jchiquet/rggm/blob/master/vignettes/GGM_data_generation.Rmd"><code>vignettes/GGM_data_generation.Rmd</code></a></small>
      <div class="hidden name"><code>GGM_data_generation.Rmd</code></div>

    </div>

    
    
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">rggm</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">igraph</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">corrplot</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">Matrix</span>)</pre></body></html></div>
</div>
<div id="generating-a-graph-under-the-stochastic-bloc-model" class="section level2">
<h2 class="hasAnchor">
<a href="#generating-a-graph-under-the-stochastic-bloc-model" class="anchor"></a>Generating a graph under the stochastic bloc model</h2>
<div id="sbm-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#sbm-parameters" class="anchor"></a>SBM parameters</h3>
<p>We consider in the following an undirect network <span class="math inline">\(\mathcal{G}\)</span> with 100 nodes splitted into 3 blocks with community-like connectivity:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">nNodes</span>  <span class="kw">&lt;-</span> <span class="fl">90</span>
<span class="no">blockProp</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">.5</span>, <span class="fl">.25</span>, <span class="fl">.25</span>)   <span class="co"># group proportions</span>
<span class="no">nbBlock</span>   <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">blockProp</span>) <span class="co"># number of blocks</span>
<span class="no">connectParam</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="fl">.4</span>, <span class="no">nbBlock</span>) + <span class="fl">0.05</span> <span class="co"># connectivity matrix: affiliation network</span></pre></body></html></div>
</div>
<div id="sampling-under-the-sbm" class="section level3">
<h3 class="hasAnchor">
<a href="#sampling-under-the-sbm" class="anchor"></a>Sampling under the SBM</h3>
<p>The function <code>rSBM</code> sample a binary network under the SBM. Let us try the aformentioned set of parameters:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co">## Graph Sampling</span>
<span class="no">mySBM</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rSBM.html">rSBM</a></span>(<span class="no">nNodes</span>, <span class="no">connectParam</span>, <span class="no">blockProp</span>)
<span class="co">## Graph plotting</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">mySBM</span>, <span class="kw">vertex.color</span> <span class="kw">=</span> <span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/V.html">V</a></span>(<span class="no">mySBM</span>)$<span class="no">memberships</span>)</pre></body></html></div>
<p><img src="GGM_data_generation_files/figure-html/SBM%20sampling-1.png" width="672"></p>
</div>
<div id="adding-weights-to-the-edges" class="section level3">
<h3 class="hasAnchor">
<a href="#adding-weights-to-the-edges" class="anchor"></a>Adding weights to the edges</h3>
<p>In <strong>rggm</strong>, the user can add some random weights to the edges of an existing SBM. Those weigths are drawn under a predefined distribution (only “gaussian” and “poisson” are implemented at the moment) the parameters of which are defined blocwise</p>
<p>We consider for instance Gaussian weights in this piece of code:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co">## Sampling Gaussian weights</span>
<span class="no">mu_within</span>   <span class="kw">&lt;-</span> <span class="fl">4</span> ; <span class="no">sigma_within</span>  <span class="kw">&lt;-</span> <span class="fl">.5</span>
<span class="no">mu_between</span>  <span class="kw">&lt;-</span> <span class="fl">2</span> ; <span class="no">sigma_between</span> <span class="kw">&lt;-</span> <span class="fl">.5</span>
<span class="no">theta</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>()
<span class="no">theta</span>$<span class="no">mu</span>    <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">mu_between</span>   , <span class="no">nbBlock</span>, <span class="no">nbBlock</span>); <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="no">theta</span>$<span class="no">mu</span>)    <span class="kw">&lt;-</span> <span class="no">mu_within</span>    <span class="co"># means</span>
<span class="no">theta</span>$<span class="no">sigma</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="no">sigma_between</span>, <span class="no">nbBlock</span>, <span class="no">nbBlock</span>); <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span>(<span class="no">theta</span>$<span class="no">sigma</span>) <span class="kw">&lt;-</span> <span class="no">sigma_within</span> <span class="co"># sd</span></pre></body></html></div>
<p>Résultat convaincant</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">mySBM</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rWeightSBM.html">rWeightSBM</a></span>(<span class="no">mySBM</span>, <span class="st">"gaussian"</span>, <span class="no">theta</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/E.html">E</a></span>(<span class="no">mySBM</span>)$<span class="no">weight</span>,  <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="kw pkg">igraph</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/gsize.html">gsize</a></span>(<span class="no">mySBM</span>)), <span class="kw">freq</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">xlab</span> <span class="kw">=</span> <span class="st">"weights"</span>, <span class="kw">main</span> <span class="kw">=</span> <span class="st">"histogram of weights"</span>)</pre></body></html></div>
<p><img src="GGM_data_generation_files/figure-html/Gaussian%20weights%20plot-1.png" width="672"></p>
</div>
</div>
<div id="drawing-multivariate-gaussian-observations-faithful-to-a-the-graph" class="section level2">
<h2 class="hasAnchor">
<a href="#drawing-multivariate-gaussian-observations-faithful-to-a-the-graph" class="anchor"></a>Drawing multivariate Gaussian observations faithful to a the graph</h2>
<p>Consider the multivariate Gaussian model <span class="math display">\[
  X \sim \mathcal{N}(\mathbf{m}, \boldsymbol\Sigma), \qquad \text{with } \boldsymbol\Omega = \boldsymbol\Sigma^{-1} \text{ the precision matrix}.
\]</span></p>
<p>We would like to drawn observation of the Gaussian vector <span class="math inline">\(X\)</span> such that <span class="math inline">\(\boldsymbol\Omega\)</span> has a sparsity pattern faithful to the orginal graph <span class="math inline">\(\mathcal{G}\)</span> generated under the SBM.</p>
<div id="constructing-the-precision-matrix-and-the-variance-covariance" class="section level3">
<h3 class="hasAnchor">
<a href="#constructing-the-precision-matrix-and-the-variance-covariance" class="anchor"></a>Constructing the precision matrix and the variance-covariance</h3>
<p>The function <code>graph2prec</code> allows one to build a precision matrix <span class="math inline">\(\boldsymbol\Omega\)</span> faitful to the original graph, that is, with a sparsity pattern reflecting the graphical model of the SBM generated above. To this end, we rely on the Laplacian matrix which is set diagonal dominant by increasing iteratively its diagonal. Note that when the graph is weighted, the weighted Laplacian is used.</p>
<p>An optional argument allows to fix the conditional variance <em>a priori</em><a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>. This argument allows the user to indirectly tune the variances in the variance-covariance matrix <span class="math inline">\(\boldsymbol\Sigma\)</span>.</p>
<p>For instance, if we want to fix the conditional variances to 1 (a thus get variances all equal to 1),</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">Omega</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/graph2prec.html">graph2prec</a></span>(<span class="no">mySBM</span>, <span class="kw">cond_var</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/pkg/igraph/man/gorder.html">gorder</a></span>(<span class="no">mySBM</span>)))</pre></body></html></div>
<p>The variance-covariance <span class="math inline">\(\boldsymbol\Sigma\)</span> is then obtain be inversion, since <span class="math inline">\(\boldsymbol\Omega\)</span> is guaranted to be strictly positive-definite.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">Sigma</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html">solve</a></span>(<span class="no">Omega</span>)</pre></body></html></div>
<p>The corresponding matrices exhibit the expected strong blocwise, diagonal structure of the original affilitation graph.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>))
<span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">Omega</span>), <span class="kw">is.corr</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">tl.pos</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">'color'</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"upper"</span>, <span class="kw">diag</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">Sigma</span>), <span class="kw">is.corr</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">tl.pos</span> <span class="kw">=</span> <span class="st">"n"</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">'color'</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"upper"</span>, <span class="kw">diag</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<p><img src="GGM_data_generation_files/figure-html/plot-1.png" width="672"></p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">Sigma</span>[<span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">upper.tri</a></span>(<span class="no">Sigma</span>)])
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(<span class="no">Omega</span>[<span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">upper.tri</a></span>(<span class="no">Omega</span>)])</pre></body></html></div>
<p><img src="GGM_data_generation_files/figure-html/plot-2.png" width="672"></p>
</div>
<div id="gaussian-observations" class="section level3">
<h3 class="hasAnchor">
<a href="#gaussian-observations" class="anchor"></a>Gaussian Observations</h3>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="no">n</span> <span class="kw">&lt;-</span> <span class="fl">1000</span>
<span class="no">means</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">Sigma</span>))
<span class="no">X</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/rmgaussian.html">rmgaussian</a></span>(<span class="no">n</span>, <span class="no">means</span>, <span class="no">Sigma</span>)
<span class="no">Sigma_hat</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span>(<span class="no">X</span>))
<span class="fu"><a href="https://rdrr.io/pkg/corrplot/man/corrplot.html">corrplot</a></span>(<span class="no">Sigma_hat</span>, <span class="kw">is.corr</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">'color'</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"upper"</span>, <span class="kw">diag</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">tl.pos</span> <span class="kw">=</span> <span class="st">"n"</span>)</pre></body></html></div>
<p><img src="GGM_data_generation_files/figure-html/gaussian%20observation-1.png" width="672"></p>
<p>TO BE CONTINUED -&gt; signal seems a bit weak…</p>
</div>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>conditional variances are equal to the inverse of the diagonal in a precision matrix<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Julien Chiquet.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
